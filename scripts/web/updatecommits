#!/usr/bin/env python3

import feedparser
from jinja2 import Template

# URL of the RSS feed
rss_url = 'https://github.com/aros-development-team/AROS/commits.atom'

# Parse the RSS feed
feed = feedparser.parse(rss_url)

# Check if feed parsing was successful
#if feed.bozo:
#    print("Failed to parse the RSS feed.")
#    print(feed.bozo_exception)
#else:
#    for entry in feed.entries:
#        print(entry.title)
#        print(entry.link)
#        print(entry.author)
#        print(entry.summary)
#        print(entry.date)
#        print()


# HTML template
html_template = """
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS Feed</title>
</head>
<body>
    <h1>{{ feed.title }}</h1>
    <ul>
    {% for entry in entries %}
        <li>
            <h2><a href="{{ entry.link }}">{{ entry.title }} | {{ entry.author }} | {{ entry.date }}</a></h2>
            <p>{{ entry.summary }}</p>
        </li>
    {% endfor %}
    </ul>
</body>
</html>
"""

# Render the HTML
template = Template(html_template)
html_content = template.render(feed=feed.feed, entries=feed.entries)

# Write the HTML content to a file
with open('/home/project-web/aros/htdocs/commits.php', 'w', encoding='utf-8') as f:
    f.write(html_content)

